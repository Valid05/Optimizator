<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#4a6fa5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Ä–∞—Å–∫—Ä–æ—è —Å—Ç–µ–∫–ª–∞</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî™</text></svg>">
    <link rel="icon" type="image/png"
        href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkElEQVQ4jWNgGAWjYBSMglEwCkTlAwcAADMDAwMDI7xOQoYAAwMDQz8DA0M/AyMD9Bi1f0ITAwMDQz8DA0M/AyMDAwMDAwMDEyMDAwMDAyMjAwMDw39GBgZGRkZGRkYGBkZGBkYGBgYGBkYGBgZGBgZGBgZGBgYGBkYGRkZGRgZGRkZGRgZGBkYGBkZGRkZGBiYAAQAA5qw3s6ro9B4AAAAASUVORK5CYII=">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî™</text></svg>">
</head>

<body>
    <div class="container">
        <header>
            <h1>üî™ –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Ä–∞—Å–∫—Ä–æ—è —Å—Ç–µ–∫–ª–∞</h1>
            <div class="subtitle">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</div>
        </header>

        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">üìê –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∑–∫–∏</h2>

                <div class="form-group">
                    <label>–†–∞–∑–º–µ—Ä –ª–∏—Å—Ç–∞ —Å—Ç–µ–∫–ª–∞</label>
                    <div class="dimensions">
                        <div>
                            <label>–®–∏—Ä–∏–Ω–∞ (—Å–º)</label>
                            <input type="number" id="sheetWidth" value="260" min="1" step="1">
                        </div>
                        <div>
                            <label>–í—ã—Å–æ—Ç–∞ (—Å–º)</label>
                            <input type="number" id="sheetHeight" value="180" min="1" step="1">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>–î–µ—Ç–∞–ª–∏ –¥–ª—è —Ä–µ–∑–∫–∏</label>
                    <div class="parts-input">
                        <textarea id="partsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
—à–∏—Ä–∏–Ω–∞ x –≤—ã—Å–æ—Ç–∞

–ü—Ä–∏–º–µ—Ä:
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
187x63
154x79
223x47
138x88
196x59
171x72
209x52
145x83
182x68
231x42
162x76
198x57
177x70
215x49
152x81
189x64
167x74
204x55
142x86
179x67
226x45
159x78
193x61
173x69
211x51
149x84
185x65
163x77
200x58
135x90"></textarea>
                        <button class="example-btn" onclick="loadExample()">üìã –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–º–µ—Ä</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</label>
                    <div style="margin-top: 10px;">
                        <input type="checkbox" id="allowRotation" checked>
                        <label for="allowRotation" style="display: inline; margin-left: 8px; font-weight: 700;">
                            –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–≤–æ—Ä–æ—Ç –¥–µ—Ç–∞–ª–µ–π
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="algorithm" value="smart" checked>
                            <span>üß† –£–º–Ω—ã–π –ø–æ–∏—Å–∫ (–≥–∞—Ä–∞–Ω—Ç–∏—è –ª—É—á—à–µ–≥–æ)</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="algorithm" value="greedy">
                            <span>‚ö° –ë—ã—Å—Ç—Ä—ã–π</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="algorithm" value="parallel">
                            <span>üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="algorithm" value="genetic">
                            <span>üß¨ –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="radio" name="algorithm" value="annealing">
                            <span>üî• –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–∂–∏–≥–∞</span>
                        </label>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #444;">
                        <div><strong>üß† –£–º–Ω—ã–π –ø–æ–∏—Å–∫:</strong> —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π (–¥–æ–ª—å—à–µ, –Ω–æ
                            –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ)</div>
                        <div><strong>üöÄ –ê–≤—Ç–æ:</strong> —É–º–Ω—ã–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º –∑–∞–¥–∞—á–∏</div>
                        <div><strong>‚ö° –ë—ã—Å—Ç—Ä—ã–π:</strong> –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á</div>
                        <div><strong>üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π:</strong> —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç 6 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, —á–∞—Å—Ç–æ –ª—É—á—à–∏–π</div>
                        <div><strong>üß¨ –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π:</strong> —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ä–º</div>
                        <div><strong>üî• –û—Ç–∂–∏–≥:</strong> –¥–ª—è –æ—á–µ–Ω—å –ø–ª–æ—Ç–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏</div>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn btn-primary" onclick="calculateOptimization()">
                        ‚ö° –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
            </div>

            <div class="output-section">
                <div class="loading" id="loading" style="display: none;">
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                        <div class="progress-info">
                            <span id="progressText">0%</span>
                            <span id="progressStatus">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</span>
                        </div>
                    </div>
                </div>

                <div id="results" style="display: none;">
                    <h2 class="section-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h2>

                    <div class="algorithm-info" id="algorithmInfo" style="display: none; margin-bottom: 25px;">
                    </div>

                    <div class="results-summary">
                        <h3>–°–≤–æ–¥–∫–∞</h3>
                        <div class="summary-grid" id="summaryGrid"></div>
                    </div>

                    <div id="sheetsContainer"></div>

                    <div class="instructions" id="instructionsContainer"></div>
                </div>

                <div id="initialState" style="text-align: center; padding: 50px 20px;">
                    <h2 style="color: #666; margin-bottom: 20px;">üëà –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"</h2>
                    <p style="color: #888; font-size: 1.1em;">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–∫—Ä–æ—è —Å—Ç–µ–∫–ª–∞
                    </p>
                    <div style="margin-top: 30px; color: #aaa;">
                        <p>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <strong>üß† –£–º–Ω—ã–π –ø–æ–∏—Å–∫</strong> –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ª—É—á—à–µ–≥–æ
                            —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fallback –¥–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞ -->
    <div id="offline-notice"
        style="display: none; position: fixed; top: 20px; right: 20px; background: #f44336; color: white; padding: 15px; border-radius: 8px; z-index: 10000;">
        ‚ö†Ô∏è –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ
    </div>

    <script src="GlassCutting.js"></script>

    <script>
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –¥–ª—è PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
                    })
                    .catch(error => {
                        console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker:', error);
                    });
            });
        }

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            const partsInput = document.getElementById('partsInput');
            if (partsInput && partsInput.value.trim()) {
                localStorage.setItem('glassCutter_lastInput', partsInput.value);
            }
        });

        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            const savedInput = localStorage.getItem('glassCutter_lastInput');
            if (savedInput) {
                const partsInput = document.getElementById('partsInput');
                if (partsInput) {
                    partsInput.value = savedInput;
                }
            }
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞
        window.addEventListener('online', () => {
            document.getElementById('offline-notice').style.display = 'none';
        });

        window.addEventListener('offline', () => {
            document.getElementById('offline-notice').style.display = 'block';
        });

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        if (!navigator.onLine) {
            document.getElementById('offline-notice').style.display = 'block';
        }

        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        document.addEventListener('DOMContentLoaded', function () {
            const partsInput = document.getElementById('partsInput');
            if (partsInput) {
                partsInput.addEventListener('keydown', function (e) {
                    if (e.ctrlKey && e.key === 'Enter') {
                        calculateOptimization();
                    }
                });
            }
        });
    </script>
</body>

</html>